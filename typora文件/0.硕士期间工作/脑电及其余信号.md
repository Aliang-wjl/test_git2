# EEG、 EOG、EMG、ECG 及呼吸信号(respiratory signal or  respiratory wave)

==ICA基础理论介绍：== 

对经常处理脑电信号的朋友来说，降噪是必不可少的环节。眼动、眨眼、肌肉运动、脉搏等噪声会严重污染脑电，严重影响脑电的后续分析。2001年提出的FastICA算法使ICA可以真正稳定地分析数据。独立成分分析（Independent Component Analysis, ICA）发展至今广泛地被用于脑电降噪，利用ICA去除脑电信号中的眼电、心电噪声是很成熟的技术。不过在实际应用ICA算法时会碰到各种问题，比如应用时==如何确定独立源个数、如何识别哪些是噪声、反过来如何识别哪些是脑电==等等。本文想讨论ICA存在问题，并引出解决部分问题的另一个算法，准确来说是另一类算法，即联合盲源信号分离。本文不会介绍联合盲源信号分离，只是提供一种思想。下面将讨论，上面提出的三个问题。

**FastICA（Fast Independent Component Analysis）是一种基于独立成分分析（ICA）的算法，用于从混合信号中提取出原始信号的方法。FastICA是ICA的一种快速实现方法，区别于传统的ICA算法，其优势在于计算效率更高。传统的ICA算法通常采用梯度下降等迭代方法来计算独立成分，需要对整个数据集进行多次迭代，计算量较大。而FastICA通过引入非高斯性和正交性的约束条件，可以直接通过一次迭代来估计独立成分，大大提高了计算效率。另外，FastICA还有一些额外的优化技巧，如采用近似的逆函数来加快计算速度，以及使用快速傅里叶变换等方法来加速矩阵运算。这些技巧使得FastICA在处理大规模数据时更加高效。**



关于第一个：如何确定独立源个数.
一般来说，我们设定20-30个独立源即可，而且只去除可以肯定的噪声。ICA目标是利用信号的不同统计特征，寻找一组混杂信号中原始的或者说独立产生信号的信号发生源。眼电和心电信号有自己特有的统计特征，这才是可分离、可识别的基础，也为自动识别提供了可能性。为了不让脑电成分分离到噪声上，一般不建议设定多数的独立源。

关于第二个：如何识别那些是噪声.
ICA分离结果具有不确定性。很多噪声无法非人为的识别。如果脑电信号记录很长，远长于噪声持续时间，一些噪声会淹没在信号中难以分离。对于短时噪声来说，本身并不存在全局意义上的解混矩阵，识别就更难了。

关于第三个：如何识别那些是脑电成分.
识别方式很有限。在一段时间内脑电应该是比较稳定的振荡，



##  对称融合和非对称融合之间的主要区别如下:

1. 融合源的数量。

对称融合是将两个或多个同等重要的信息源融合在一起。所有源的贡献是相同的。

非对称融合允许信息源的贡献不平衡。一般来说,有一个主要的信息源和一个或多个次要信息源。

2. 权重。 

在对称融合中,所有信息源都具有相同的权重。

在非对称融合中,主要信息源的权重通常高于次要信息源。权重可以根据各信息源的可靠程度和精确度动态调整。

3. 融合策略。

对称融合通常采用平均或投票方式融合不同源的决策。

非对称融合允许将主要信息源的决策直接作为结果,或者将次要信息源的决策作为辅助信息修改主要信息源的决策。

4. 计算复杂度。

对称融合的计算复杂度较低,直接平均或投票即可。

非对称融合需要考虑各信息源的贡献程度,计算复杂度较高。

5. 应用场景。

对称融合适用于各信息源质量相似的情况。

非对称融合更适用于存在主次关系的信息源,或在决策要求下需要优先采纳主要信息源观点的场景。

总之,非对称融合相对对称融合更加灵活,但计算更复杂。选择哪一种需要根据实际问题的特点来定。

 对称融合和非对称融合之间的主要区别如下:

1. 融合源的数量。

对称融合是将两个或多个同等重要的信息源融合在一起。所有源的贡献是相同的。

非对称融合允许信息源的贡献不平衡。一般来说,有一个主要的信息源和一个或多个次要信息源。

2. 权重。 

在对称融合中,所有信息源都具有相同的权重。

在非对称融合中,主要信息源的权重通常高于次要信息源。权重可以根据各信息源的可靠程度和精确度动态调整。

3. 融合策略。

对称融合通常采用平均或投票方式融合不同源的决策。

非对称融合允许将主要信息源的决策直接作为结果,或者将次要信息源的决策作为辅助信息修改主要信息源的决策。

4. 计算复杂度。

对称融合的计算复杂度较低,直接平均或投票即可。

非对称融合需要考虑各信息源的贡献程度,计算复杂度较高。

5. 应用场景。

对称融合适用于各信息源质量相似的情况。

非对称融合更适用于存在主次关系的信息源,或在决策要求下需要优先采纳主要信息源观点的场景。

总之,非对称融合相对对称融合更加灵活,但计算更复杂。选择哪一种需要根据实际问题的特点来定。



## 功能性磁共振成像(fMRI)和常规磁共振成像(MRI)的主要区别有:

1. 成像目标不同:MRI成像主要用于检测脑部和其他组织的解剖结构,而fMRI重点研究脑部不同区域的功能性活动变化。
2. 成像原理不同:MRI采用静磁场与射频脉冲进行成像,而fMRI利用BOLD（blood oxygen level dependent）效应间接检测神经活动级别,即通过对比静态与动态成像结果来定位活跃脑区。
3. 时间分辨率不同:MRI获得的是一个静态立体图像,无法观察变化过程;而fMRI可以以较高的时空分辨率实时监测不同功能区域的活动变化。
4. 成像对比度不同:MRI图像呈现组织解剖结构,对比度较高;fMRI定位脑功能但对比度较低,需要计算机分析统计才能看出活跃区。
5. 应用目的不同:MRI主要用于病理诊断；fMRI重点用于研究正常人和病人的脑功能与认知过程的神经机制。

所以总体来说,fMRI相比MRI多考虑时间分辨能力和功能定位,是一种宏观的神经影像技术。



## fMRI图像预处理

[参考链接](https://www.pianshen.com/article/55581159717/)



## ==多模态神经成像之EEG-fMRI同步：==

[参考链接](https://www.bilibili.com/read/cv19514542/)
功能性磁共振成像(fMRI)和脑电图(EEG)是用于测量人脑神经活动的非侵入性技术。 
**fMRI**测量的是与神经活动血流动力学变化相关的磁共振信号，具有良好的空间分辨率(2-3mm各向同性)和较低的时间分辨率(1-3s)。而**EEG**用于以毫秒级的时间分辨率记录大脑中的电活动，但空间分辨率有限。
通过fMRI和EEG的结合，可以生成人脑功能的高时空分辨率图，这对于理解人脑的复杂动力学是至关重要的。此外，fMRI期间的EEG记录可用于识别大脑中异常电活动的来源。

**血氧水平依赖(BOLD)fMRI**
fMRI的空间分辨率由体素大小决定，体素大小通常在2-3mm各向同性范围内。较小的体素会降低信噪比(SNR)，而较大的体素则会引入==较低的空间特异性和部分容积效应==。超高场MRI存在的困难包括，扫描成本，有限的可用性和安全问题，因而经常使用这些扫描仪是不切实际的。

**脑电图（EEG）**
EEG通过在头皮上放置导电电极来测量大脑的电活动。与fMRI相比，EEG可以以高时间分辨率捕获电活动。因此，它在临床上通常用于神经系统疾病的诊断和评估，特别是癫痫。EEG也是对人类不同睡眠阶段进行分类的黄金标准方法，它通常用于睡眠障碍的评估。

**在MRI扫描仪中记录EEG**
90年代初，首次报告了在MRI扫描仪内记录的EEG信号。这些早期举措主要是由于临床需要使用MRI内记录的EEG来识别癫痫样活动的空间来源。因此，EEG主要用于检测癫痫发作，而fMRI则用于定位，使其具有良好的空间精度。将EEG电极放置在MRI扫描仪中患者的头部有几个风险，包括(1) 金属EEG电极附近组织的局部发热，(2)电击和 (3) 神经刺激。 
==采集方法：== 交错采集（需要无梯度伪影的EEG数据或者没有MRI音频噪声的短暂间歇期）和连续采集（癫痫以及认知神经科学研究的首选方法）。 

**伪影去除技术**

==(1) 梯度伪影==

MRI扫描仪使用由梯度和RF线圈产生的时变磁场对MR信号的空间信息进行编码并创建图像。当EEG硬件(电极、电线和放大系统)放置在MRI扫描仪内时，时变电磁场会在被试头部和EEG硬件形成的导电回路内产生杂散电压信号(==梯度伪影==)。与神经生理EEG信号相比，梯度伪影的振幅非常大(＞100倍)。

A.基于减法的去噪
从固定数量的样本中计算出平均成像伪影模板，然后从每个样本的EEG信号中减去该模板。
==自适应伪影减法(AAS)==方法正常工作的先决条件是必须准确计算伪影模板。 
基于减法去噪的第二个重要考虑因素是第一次去噪后的残差噪声。 

B.梯度伪影的盲源分离
盲源分离技术，如独立成分分析(ICA)，已被成功地用于从EEG数据中提取噪声污染。
ICA试图从M个线性组合的源信号中分离出N个统计上相互独立的源信号。ICA可用于原始EEG数据，将EEG分为信号源和噪声源。然后通过成分回归从信号中去除噪声成分。

==从EEG中去除梯度和心动图伪影概述：==
1.gradient artifact removal using artifact subtraction  利用伪影减法去除梯度伪影。
2.down sample  and  Low pass filter  and  ICA decomposition     下采样，低通滤波  和 ICA分解，寻找BCG成分
3.Regress out noise components   回归噪声分量

C.基于硬件的方法

==(2)心冲击图(BCG)伪影==
由于在MRI扫描仪的强磁场中，脉动使头皮扩张或收缩时，头皮电极上会产生杂散电压，以及传导血液的脉动而引起的霍尔效应。即使是由于脉动运动引起EEG电极的微小运动也可以转化为电信号，该电信号可能比感兴趣的EEG信号大几倍。由于心搏的时间变异性，BCG伪影很难从EEG数据中完全去除。

A.BCG伪影的自适应减法

B.BCG伪影的盲源分离

C.基于硬件的方法

**同步fMRI-EEG数据分析**
同步fMRI-EEG分析的方法可分为对称融合和非对称融合。非对称融合技术旨在将源自EEG的大脑信号拟合到fMRI数据(EEG-informed fMRI)，或者相反，将源自fMRI的大脑信号拟合到EEG数据(fMRI-informed EEG)，从而提高时空分辨率，循证神经过程。相比之下，对称融合旨在整合fMRI和EEG数据，并对潜在神经活动进行最少的预先假设。

![img](https://i0.hdslb.com/bfs/article/6c476d04856db7a6955968456c7f29c582d0e4d6.png@1256w_948h_!web-article-pic.avif)





## 同步脑电图-功能磁共振融合推断宏观脑动力学

[参考链接](https://blog.csdn.net/cc1609130201/article/details/123788551)

同步脑电-功能性磁共振成像(EEG-fMRI)包含的两种数据进行融合时有两种方式：对称融合 和 不对称融合。

随着技术的进步和融合方法变得更加复杂，EEG-fMRI 为无创脑动力学测量带来了许多新的启示，**包括：基于目标扰动的神经成像、利用深度学习发现电生理和血流动力学测量之间的非线性表征等新的研究领域。**

**1.介绍**

* 脑电图和功能磁共振成像在**空间和时间分辨率**方面是互补的。当前采用同时获取EEG和fMRI的应用仍然很少。
* 最初这种未充分利用的情况很大程度上归因于与**电磁干扰**相关的技术障碍，但得益于电子技术和电磁屏蔽技术的改进，当前获取数据这块已经不是问题。以往存在的主要挑战不再是同时获取数据的技术困难**，而是缺乏有效和有原则的数据融合方法，特别是能够在认识到两种模式的独特优势和弱点的同时，以高保真度最佳地结合信息的工具**。
* 总的来说，EEG-fMRI数据融合方法可分为两类：**非对称融合和对称融合。如果一个模态被视为一个先验或约束来指导其他模态的分析，则融合是不对称的。反之，如果将从每个模态的信息以类似平均的方式使用，则融合是对称的。**对称融合可以进一步分为两类：**模型驱动和数据驱动。** 相对来说，数据驱动更简单，**直接利用EEG和fMRI在特征空间中的协方差**，不考虑它们潜在的生物物理特性可能存在的差异。

**2.EEG-fMRI采集**

* 脑电图可以获取头皮上电极的电活动，这些电活动是由神经元群同步去极化产生的。头皮脑电图测量的**主要贡献者是皮层锥体神经元突触后电位。**由于容积传导，推断头皮脑电图的潜在来源是一项研究中的重要挑战，因为一般的假定是：**在一个电极上的电信号测量是多个源信号的总和，其中包括那些远离记录电极的源。**因此，头皮脑电图的主要局限性是缺乏空间分辨率。然而，脑电图可以提供毫秒级的时间分辨。
* **BOLD信号与脑电图在不同频段的频谱功率有关。尽管fMRI具有较高的空间分辨率和全脑覆盖，但其较差的时间分辨率以及血流动力学响应的区域差异，给fMRI数据分析带来了重大挑战。**
* 脑电图-功能磁共振成像采集的目的是提供具有高度时间特异性和解剖定位的人类大脑的非侵入性成像。当同时采集时，这两种模式的**信噪比(SNR)都降低了。** 磁共振(MR)扫描仪内收集的脑电图表现出两种主要的**大型和周期性伪影：** ==梯度和心冲击。==   **梯度伪影是由梯度磁场的转换引起的。**  
  BCG伪影更为复杂，BCG主要来自与心动周期同步的脑电图电极的脉动运动。
  **梯度伪影与BCG伪影和真实神经信号相比，大约大10倍。**

**3.融合EEG-fMRI**

* **非对称融合是指将一个模态的信息作为另一个模态的先验或加权。**例如，**EEG信息(如振幅、频率和相位)可以作为BOLD预测因子纳入fMRI的一般线性模型(GLM)分析。**

* 当脑电与功能磁共振成像信息相等时，融合是对称的。模型驱动的对称融合试图对共享但未观察到的神经状态进行建模，从而产生脑电图和功能磁共振成像记录。

* 数据驱动的对称融合是指利用**独立分量分析(ICA)和线性回归等机器学习方法将脑电和功能磁共振成像(fMRI)融合在一个共同的特征空间中。这些方法通常不采用关于脑电图和功能磁共振成像的生理学假设。**

* 非对称融合
  **两种区分阳性和阴性结果的时间特异性脑电图成分**。
  这种基于EEG的功能磁共振成像分析的一个潜在的重要的优点是它可以在**更深处显示激活的皮层下结构。**

* 对称融合
  对称融合技术将脑电和功能磁共振成像的信息进行均衡融合，以避免由于不均衡使用各模态信息而导致的推断$σ_c$的偏差。

  分为模型驱动和数据驱动。
  数据驱动专注于**平衡两个目标:(a)在每个模态中设计可以预测试次标签的多元分类器；(b)让这些分类器共享试次到试次变异的相似模式——也就是说，每个模态的预测输出应该是相关的。**

**4.未来方向**

* **超高磁共振场的脑电图-功能磁共振成像**
* **靶向神经刺激和基于干扰的神经成像**
  集成的EEG-TMS系统被用于提供时间精度和定位，即通过触发刺激，给定脑电图动力学。相反，fMRI-TMS系统关注的是空间精度，目的是确定在局部刺激时哪些网络和远端节点受到影响。包括我们在内的一些团队最近一直在致力于开发综合脑电图-功能磁共振-磁刺激系统。
* **脑电-功能磁共振融合的深度学习模型**
  尽管深度学习模型通常被认为是一个黑盒子，难以解释，但这些模型在某些方面与脑电图-功能磁共振成像融合问题非常匹配。例如，**卷积神经网络(CNNs)实现时间和/或空间卷积运算符，这些运算符在形式上与线性化的正向模型相似，后者通常用于将神经源映射到脑电图和功能磁共振成像测量空间。** 仿真结果表明，该方法能够在脑电图的时间分辨率下学习潜在源空间，但空间分辨率接近于功能磁共振成像，并能从给定的新测试数据中生成一种模式。鉴于深度学习方法的持续发展和脑电图-功能磁共振成像数据的可能增加，与脑电图-功能磁共振成像融合相关的其他深度学习发展很可能即将出现。



## 脑结构磁共振成像数据处理

[参考链接](https://zhuanlan.zhihu.com/p/143491276)

**一、数据质量检查**

**主要包括：**扫描参数检查，包括体素大小、层厚等参数，确保参数合适与统一；图像伪迹检查，包括鬼影、变形等；其他检查，包括图像是否缺损、图像原点位置等。



**二、基于体素的形态学测量分析（VBM）**

**主要包括：**

1. **组织分割。**基于DARTEL方法，将结构像分割为灰质、白质、脑脊液。
2. **空间标准化、调制。**将灰质、白质、脑脊液图像配准到标准脑模板空间；随后基于配准生成的形变场，对图像进行调制，生成**灰质体积、白质体积**等指标图；不经过调制，可生成**灰质密度、白质密度**等指标图。除此之外，也可计算**灰质总体积、白质总体积、颅内总体积、灰质总体积/颅内总体积比值、白质总体积/颅内总体积比值**等综合指标。
3. **统计分析（体素水平）。**
4. **基于ROI的相关分析。**
5. **结果可视化。**



**三、基于表面的形态学测量分析（SBM）**

**主要包括：**

1. **组织分割与皮层重建。**对结构像进行分割，并重建皮层。
2. **皮层指标计算。**
   * 常规皮层指标，包括**皮层厚度、曲率**等；
   * 复杂度指标，包括**局部回指数、脑沟深度、分形维度**等指标。
3. **统计分析（顶点水平）。**
4. **基于ROI的统计分析。**
5. **结果可视化。**

**四、结构协变网络**

* 如果您关注脑发育相关或者进程缓慢的脑疾病，结构协变网络是一种具有潜力与可解释性的分析方法。
* 结构协变网络的构建；图论分析；统计分析

**五、皮层下区域体积分析**
尺度更小的分析，如海马、杏仁核的亚区分割，如今也可以实现

**主要包括：**

1. **海马亚区分割与体积分析**
2.  **杏仁核亚区分割与体积分析。**
3. **结果可视化。**

**六、皮下结构shape分析**

**七、结构-DTI指标联合分析**











1. 这些缩写代表不同类型的生理信号：

   - EEG：脑电图（Electroencephalography），记录大脑皮层的电活动。
   - EOG：眼电图（Electrooculography），用于记录眼睛运动产生的电位，通常用于睡眠研究和眼动追踪。
   - EMG：肌电图（Electromyography），用于记录肌肉电活动，通常用于评估肌肉功能和神经肌肉疾病。
   - ECG：心电图（Electrocardiography），用于记录心脏的电活动，通常用于诊断心脏疾病和评估心脏功能。
   - PPG ：光学脉搏图（Photoplethysmogram），这是一种用于测量==脉搏和血流==的生理信号，通常通过皮肤上的光电传感器来获取。PPG 可以提供有关心率、血压和其他循环系统特征的信息。

2. 数据集有哪些 ：

   * PhysioNet（https://physionet.org/）

     提供多种生理信号数据集，其中包括心脏、脑电、生理监护和个人健康等多个领域的数据。

     * 1  [心算前后受试者的脑电图](https://physionet.org/content/eegmat/1.0.0/)  EEG During Mental Arithmetic Tasks
       `_1表示心算前的脑电，_2表示心算期间的脑电`， 在[subject-info.csv](https://physionet.org/content/eegmat/1.0.0/subject-info.csv)文件中，`0代表B组，执行心算质量较差，1代表G组，执行心算质量较好`
       通道数为23，30hz的高通滤波器和50hz的陷波滤波器；时间长度均为1min，==采样率未知==

       ==对数据的操作方式：==
       第一个标签类型可以按照心算前与心算中进行区分，心算前为0，心算中为1；
       第二个标签类型可以按照心算中质量进行区分，质量较差为0，质量较好为1。
       第三个标签类型就是融合上述两种，心算前为0，心算中质量较差为1，较好为2
       **最终使用的标签类型就是第三种，后续如果想使用二分类数据，则合并1与2，或者不用0，只用1和2，只不过只用1和2数据量会太少**
       
       
       
     * 2   [脑电图运动/图像数据集](https://physionet.org/content/eegmmidb/1.0.0/)   EEG Motor Movement/Imagery Dataset
       该数据集由 109 名志愿者获得的 1500 多个一分钟和两分钟脑电图记录组成，如下所述。
       `64通道脑电图，每个受试者进行14次试验，采样率160hz，`
       官方给出的注释是划分成了3个阶段，T0,T1,T2。 T0对应的是任务1和2，T1和T2界限过于模糊
       
       ==对数据的操作方式：==
       
       <img src="../../../AppData/Roaming/Typora/typora-user-images/image-20240505160427536.png" alt="image-20240505160427536" style="zoom:50%;" />
       
       
       
       
       
       
       
     * 3  [观看电影幻想曲时年轻人和老年人不同的心电图和呼吸信号](https://physionet.org/content/fantasia/1.0.0/)  Fantasia Database
       共采集了均为健康者的20名年轻人和20名老年人，男女比例1:1，采样率250Hz，其中部分数据包含了血压信号，但是并没有进行校准，每个人采集了两个小时。
       主要的数据为 ECG and 呼吸信号，附带有节拍注释，是ECG数据的。
       观看电影的目的是为了让受试者保持窦性心律的静息状态，以帮助保持清醒。f1y01 带有y的为年轻人， f1o01带有o的为老年人。 其中f2中包含了血压信号。
     
       ==对数据的操作方式：==
     
       只能以年轻人和老年人对数据进行分类，年轻人为0，老年人为1。
     
       
     
     * 4 [CAP Sleep Database](https://physionet.org/content/capslpdb/1.0.0/)  
     
       ==简介：==
       CAP睡眠数据库，Cyclic Alternating Pattern (循环交替模式，周期性交替模型)，
       NREM睡眠是非快速眼动睡眠（Non-Rapid Eye Movement Sleep）的缩写，也称为静态睡眠。它包括三个阶段：N1、N2和N3。在这三个阶段中，身体逐渐放松，心率和呼吸变缓，脑电图呈现出不同的波形，这些波形反映了大脑活动的不同状态。NREM睡眠期间，人们的大脑和身体都处于放松和恢复的状态，这对于身体的健康和精神状态都非常重要。
       数据集的目的是为了进行睡眠阶段的==评分==。所以最终训练的网络也可以给出分数，而不是简单的分类。
     
       ==数据集简介==
       108 条多导睡眠图记录。每个记录包括3个或更多脑电图信号，以及眼电图、颏肌电图和胫肌电图、气流、呼吸强度、血氧饱和度和心电图信号，以及参考睡眠阶段和 CAP 注释。该数据库旨在提供大量析仪，以及支持对 CAP 动态的基础研究。
       16个健康人，92个病人，这些病人中40个人为NFLE，22个人为RBD，10个人为PLM，9个人为失眠症患者，5个人为发作性睡病。4个人为SDB，2个人有磨牙症。
       <img src="../../../AppData/Roaming/Typora/typora-user-images/image-20240102163836757.png" alt="image-20240102163836757" style="zoom:67%;" />
     
       ==对数据的操作方式：==
     
       根据上面图片中的各种疾病，进行标签标定。
       n 0, brux 1, ins 2, narco 3, nfle 4, plm 5, rbd 6, sdb 7.   分为8类。 ==但是数据很不平衡。==
     
       如果按照给分的话，可以怎么考虑？
       本身给的注释中包含了评分。具体需要查看分数文件夹是怎么样的再做判断，目前通过查看官网解释感觉不太适合用于评分。
     
       
     
     * 5  [BIDMC PPG and Respiration Dataset](https://physionet.org/content/bidmc/1.0.0/)   PPG 和呼吸数据集
       ==简介==
       每个数据都是从住院的==危重患者==身上获取的。其中的呼吸信号被标注了，每一个呼吸信号持续时间为8分钟。数据集中包含了53个录音。每个录音包含了生理信号(PPG， 阻抗呼吸信号，心电图)，采样率为125hz，生理参数（心率，呼吸频率，血氧饱和度），采样率为1hz，呼吸波的手动标注。
     
       
     
       ==对数据的操作方式：==
     
       在csv文件中已经有了原始数据，所以我们可以直接读取原始数据来进行分类。
       其中Time为是时间列，采样率为125hz，RESP为呼吸波形，PLETH为脉搏波形，V为心电导联中的心室波形，II为二导联心电图，AVR为心电导联。其中bidmc_01_Breaths.csv文件夹是记录的呼吸波形波峰的位置，对应的值是点的个数。
       **数据集起初是用来评估算法的性能，算法的目的是用ppg信号估计呼吸频率**
     
       ==但是无法考虑数据怎么使用，因为相当于全是一个类别==
       
       ![image-20240103211115415](../../../AppData/Roaming/Typora/typora-user-images/image-20240103211115415.png)
       
       
       
     * [MIMIC-III 波形数据库](https://physionet.org/content/mimic3wdb/1.0/)
       ==简介==
       MIMIC-III 波形数据库包含约 30,000 名ICU患者的 67,830 个记录集。包括ECG，ABP(Arterial Blood Pressure 连续动脉血压)，respiration(呼吸波形) and PPG，以及其他常见信号。 
       该数据库中的生理波形记录包含最多 8 个同时记录的信号，以 125 Hz 的频率、8 位、10 位或（偶尔）12 位分辨率进行数字化。数字记录通常包含每秒或每分钟采样一次的 10 个或更多生命体征时间序列。==推测这里的12位指的应该是采样精度，之后再缩放中会降低分辨率。==
     
       ==数据集使用==
       数据集过大，达到了==6.7TB==，自己无法处理且使用这么庞大的数据集。==放弃使用==
     
       
     
     * 6 [PTB-XL, a large publicly available electrocardiography dataset](https://physionet.org/content/ptb-xl/1.0.3/)  这是一个大型公开心电图数据集
     
       ==简介：==
       PTB-XL ECG 数据集是一个大型数据集，包含来自 18869 名患者的 21799 个临床 12 导联心电图，长度为 10 秒。其中 52% 是男性，48% 是女性，年龄涵盖 0 到 95 岁的整个范围（中位数 62，分位数范围为 22）
       波形文件以波形数据库 (WFDB) 格式存储，精度为 16 位，分辨率为 1μV/LSB，采样频率为 500Hz ( `records500/`)。为了方便用户，我们还发布了采样频率为 100Hz 的波形数据的下采样版本 ( `records100/`)。
     
       推荐的 10 倍训练测试分割 ( ) 通过分层抽样获得，同时尊重患者分配，即特定患者的所有记录都分配到相同的折叠。第 9 和第 10 折中的记录至少经过一次人工评估，因此具有特别高的标签质量。因此，我们建议使用折叠 1-8 作为训练集，折叠 9 作为验证集，折叠 10 作为测试集。
     
       ==数据集使用==
       数据集划分可以在推荐数量的基础上增加验证集和测试集，或者直接将9和10作为测试集，7和8作为验证集，其余为训练集。
       <img src="../../../AppData/Roaming/Typora/typora-user-images/image-20240103214911220.png" alt="image-20240103214911220" style="zoom:67%;" />
     
       
     
     * 7  [The CirCor DigiScope Phonocardiogram Dataset](https://physionet.org/content/circor-heart-sound/1.0.3/)  心音数据集
     
       ==简介：==
     
       从 1568 名受试者的主要四个听诊部位收集了总共 5272 条心音记录。
     
       截止2022年5月10号，这个数据集是最大的公开的儿科心音数据集。该数据集正用于 2022 年 George B. Moody PhysioNet Challenge 挑战赛，该挑战赛旨在通过心音图记录进行心脏杂音检测。
       心脏听诊的位置：主动脉瓣，肺动脉瓣，三尖瓣，二尖瓣。采样率是4k。
       数据集中的每个心脏杂音都由人类注释者在时间、形状、音调、分级、质量和位置方面进行了详细注释。另外注释中还包含了半监督方案进行S1，S2分割的注释，并在算法不同意或专家不可接受时进行手动注释。
     
       ==数据集使用：==
     
       不使用提供的分割标记，仅查看注释内容，可以的话就用于分类，应该是主要依靠  ==质量==
       ==需要查看注释文件在进行判别==
     
       
     
     * 8  [用于心律失常研究的大规模 12 导联心电图数据库](https://physionet.org/content/ecg-arrhythmia/1.0.0/)  A large scale 12-lead electrocardiogram database for arrhythmia study
       其中包含 45,152 名患者的 12 导联心电图，采样率为 500 Hz，具有多种常见心律和其他心血管疾病，全部由专业专家标记。该数据集可用于在心律失常和其他心血管疾病的研究中设计、比较和微调新的和经典的统计和机器学习技术。
     
       ==数据集使用==
     
       没有看到对应的标签注释，需要下载完查看数据在进行定夺，但是看解释中有关于一些异常疾病的说明，猜测也是进行了标注
     
       ![image-20240103221650584](../../../AppData/Roaming/Typora/typora-user-images/image-20240103221650584.png)
     
       
     
     * 9  [Haaglanden Medisch Centrum sleep staging database](https://physionet.org/content/hmc-sleep-staging/1.1/)  Haaglanden Medisch Centrum 睡眠分期数据库
       2018 年在 Haaglanden Medisch Centrum（HMC，荷兰）睡眠中心收集的 151 条整夜多导睡眠图 (PSG ，Polysomnography) 睡眠记录（85 名男性，66 名女性，平均年龄为 53.9 ± 15.4 岁）的集合。患者记录是随机选择的，包括异质人群，这些人群被转介进行针对不同睡眠障碍背景的 PSG 检查。==该数据集包含脑电图 (EEG)、眼电图 (EOG)、下巴肌电图 (EMG) 和心电图 (ECG) 活动，以及与 HMC 睡眠技术人员执行的睡眠模式（睡眠图）评分相对应的事件注释。==该数据集是作为评估自动睡眠评分算法在多个异构数据集上的泛化性能的研究的一部分而收集的。
       PSG 数据包括 4 个 EEG（F4/M1、C4/M1、O2/M1 和 C3/M2）、2 个 EOG（E1/M2 和 E2/M2）、1 个双极下巴 EMG 和 1 个 ECG（单修改导联） II) 推导。
     
       多导睡眠图记录的生理参数通常包括以下几个方面：
     
       1. 脑电图（Electroencephalogram, EEG）：记录大脑皮层神经元活动的电信号，用于评估睡眠阶段和睡眠深度。
       2. 眼电图（Electrooculogram, EOG）：记录眼球运动的电信号，用于检测快速眼动（REM）睡眠期间的眼球活动。
       3. 下巴肌电图（Electromyogram, EMG）：记录下巴肌肉的电信号，用于监测肌肉活动和肌肉松弛。
       4. 心电图（Electrocardiogram, ECG）：记录心脏的电信号，用于评估心脏节律和心率。
       5. 呼吸流量（Respiratory Flow）：记录呼吸过程中的气流变化，用于检测呼吸暂停、鼾声等呼吸问题。
       6. 呼吸胸带（Respiratory Effort）：记录胸部和腹部的运动，用于评估呼吸努力和呼吸节律。
       7. 血氧饱和度（Oxygen Saturation）：记录血液中的氧气饱和度，用于评估睡眠呼吸暂停和低氧血症。
     
       5,6,7在这个数据集中是没有的
     
       所有信号均以 ==256 Hz== 采样。
     
       HMC 睡眠分期数据库可能会让研究人员根据临床睡眠评分标准研究与睡眠过程相关的生理变化以及与不同睡眠阶段的关系感兴趣 [1]。此外，该数据还可用作自动睡眠评分算法的开发和验证的基准数据集。作为参考，请参阅我们关于自动睡眠评分和解决数据库变异性的相关论文 [2,6]。
     
       1. 阿尔瓦雷斯-埃斯特维兹，D. 和费尔南德斯-瓦雷拉，I. (2020)。解决从医疗数据学习中的数据库变异性：使用卷积神经网络的基于集成的方法以及应用于自动睡眠评分的研究案例。生物学和医学计算机，119, 103697. doi:10.1016/j.compbiomed.2020.103697
       2. Alvarez-Estevez D、Rijsman RM (2021) 自动睡眠评分深度学习方法的数据库间验证。《公共科学图书馆 ONE》16(8)：e0256111。https://doi.org/10.1371/journal.pone.0256111
     
       ==数据使用==：
     
       目前来看，我们无法知道数据如何使用，但是里面的注释应该有关于睡眠评分的描述，另外后续肯定需要参考相关文献再考虑数据的使用方式，初步来看我们可以进行睡眠评分。
     
       
     
     * 10 [Sleep-EDF Database Expanded](https://physionet.org/content/sleep-edfx/1.0.0/)  睡眠 EDF 数据库扩展
     
       sleep-edf 数据库包含 197 个整夜多导睡眠记录，其中包含脑电图、眼电图、下巴肌电图和事件标记。有些记录还包含呼吸和体温。相应的睡眠图（睡眠模式）由训练有素的技术人员根据 Rechtschaffen 和 Kales 手册手动评分，并且也可用。
     
       EOG，EMG以及EEG 信号均以 100 Hz 采样，事件标记以 1 Hz 采样。颏下肌电图信号经过电子高通滤波、整流和低通滤波，之后以 uV rms（均方根）表示的所得肌电图包络以 1Hz 采样。口鼻气流、直肠体温和事件标记也以 1Hz 采样。==该数据集没有ECG数据，且注释和上述一样，需要查看后在定夺==
     
       ==数据集使用==
       初步感觉，应该是该数据用来对睡眠质量进行评分。
     
       
     
     * 11 [BCI Competition IV](https://www.bbci.de/competition/iv/)
       “BCI(Brain-Computer Interface) 竞赛 IV”的目标是验证脑机接口 (BCI) 的*信号处理* 和*分类方法。*与过去的 BCI 竞赛相比，解决了与实际 BCI 系统高度相关的新的挑战性问题，例如
     
       - 无试验结构的连续脑电图分类（[数据集 1](https://www.bbci.de/competition/iv/#dataset1)）。
       - 受眼动伪影影响的脑电图信号的分类（[数据集 2](https://www.bbci.de/competition/iv/#dataset2a)）。
       - 根据 MEG 对手腕运动方向进行分类（[数据集 3](https://www.bbci.de/competition/iv/#dataset3)）。
       - ECoG 中需要细粒度空间分辨率的辨别（[数据集 4](https://www.bbci.de/competition/iv/#dataset4)）。
     
       ![image-20240104104747755](../../../AppData/Roaming/Typora/typora-user-images/image-20240104104747755.png)
     
       
     
       ==数据集使用：==
     
       
     
       
     
       [可参考博客](https://blog.csdn.net/AncientOne/article/details/128758355)
       [BCI比赛总网站](https://www.bbci.de/competition/)
     
     * 

3. 滤波

   * [小波滤波介绍](https://www.bilibili.com/read/cv14782372/)
   * [脑电信号（EEG）简介：原理、应用与分析方法](https://blog.csdn.net/weixin_46163097/article/details/130144155)

4. ### python脑电数据处理

   * 1 EEG 读取数据

     * 公众号：脑机接口社区   [脑电分析系列 | MNE-Python汇总](https://mp.weixin.qq.com/s/TBGVAfKiwOxke7k8xb5p9g)

     * [官方文档](https://mne.tools/stable/index.html)

     * ```python
       PySide2,pyqt5以及matplotlib的使用
       pip install PySide2
       pip install pyqt5
       # 尝试运行下列代码
       matplotlib.use('Qt5Agg') # 交互式绘图
       fig = raw_eeg.plot()
       # 如果打开的窗口一直显示未响应，多半matplotlib 版本较低，我的原来是3.3.3，不行，所以需要升级
       pip install --upgrade matplotlib # 更新完之后，版本为3.7.4
       # 查看pyqt5版本
       from PyQt5 import QtCore
       print(QtCore.PYQT_VERSION_STR)
       # 查看 matplotlib 版本
       import matplotlib
       print(matplotlib.__version__)
       # 查看PySide2版本
       import PySide2
       print(PySide2.__version__)
       ```

     * [ICA 独立成分分析教程](https://labeling.ucsd.edu/tutorial/labels)

     * <img src="../../../AppData/Roaming/Typora/typora-user-images/image-20240109143902693.png" alt="image-20240109143902693" style="zoom:67%;" />

     * [ICA 头皮层图像判断](https://zhuanlan.zhihu.com/p/592670433?utm_id=0)

     * <img src="../../../AppData/Roaming/Typora/typora-user-images/image-20240109144657098.png" alt="image-20240109144657098" style="zoom:67%;" />

     * <img src="../../../AppData/Roaming/Typora/typora-user-images/image-20240109144804340.png" alt="image-20240109144804340" style="zoom:67%;" />

     * <img src="../../../AppData/Roaming/Typora/typora-user-images/image-20240109144923496.png" alt="image-20240109144923496" style="zoom:67%;" />

     * <img src="../../../AppData/Roaming/Typora/typora-user-images/image-20240109145002235.png" alt="image-20240109145002235" style="zoom:67%;" />

     * <img src="../../../AppData/Roaming/Typora/typora-user-images/image-20240109145115343.png" alt="image-20240109145115343" style="zoom:67%;" />





# 对所有信号进行处理的方式

* ### 心音信号

  * Yaseen_2018 数据集
    该数据集采样率为8K，共有5种类别，分别是：[N,AS,MR,MS,MVP] 正常，主动脉瓣狭窄，二尖瓣关闭不全，二尖瓣狭窄，二尖瓣脱垂。
    [心脏疾病名称缩写](https://wenku.baidu.com/view/85ddd507dc36a32d7375a417866fb84ae45cc3d9.html?_wkts_=1713234289265&bdQuery=MR%2CMS%2CMVP+d%E5%AF%B9%E5%BA%94%E7%9A%84%E7%96%BE%E7%97%85)

    1. 对数据集的样本进行长度的验证
       经测试，发现数据长度低于2s的数据占4.9%，为了后续处理的统一性，我们选择直接删除这些数据。

    2. 对各类别可划分的数据量进行验证
       划分方式采用50%重叠；
       经测试，各类别划分数据量如下：[201, 232, 188, 199, 185]

    3. 对数据进行划分
       划分比例为：6:2:2
       划分依据：保证各类别在训练集，验证集和测试集中的类别为上述比例，且每个记录仅能出现在这三个数据集中的一个，不可重复出现。
       划分流程：读取数据；小波滤波；降采样至2k；最大最小归一化；进行当前数据的划分

       划分情况：
       ![image-20240416103816142](../../../AppData/Roaming/Typora/typora-user-images/image-20240416103816142.png)

  * Challenge_2016 数据集
    该数据集采样率为2k，共有七个子集，两个数据类别：正常、异常。

    1. 对数据集的样本进行长度的验证
       数据集中没有长度低于2s的数据
    2. 对各类别可划分的数据量进行验证
       正常与异常的数量为 [50712, 17218]
    3. 对数据进行划分
       划分比例为：6:2:2
       划分依据：保证各类别在训练集，验证集和测试集中的类别为上述比例，且每个记录仅能出现在这三个数据集中的一个，不可重复出现。
       划分流程：读取数据；小波滤波；降采样至2k；最大最小归一化；进行当前数据的划分
       划分情况：
       ![image-20240416110518639](../../../AppData/Roaming/Typora/typora-user-images/image-20240416110518639.png)

  * Michigan_four 数据集
    该数据采样率为：44100Hz，其数据类型较为简单，当不按照个体进行划分时，可以得到100%的分类准确度，但本次测试数据的划分是按照个体进行的，所以可以使用该数据来尝试分类。类别为：[Normal, Aorta, Mitral_valve, Pulmonary_artery]     正常，主动脉疾病，二尖瓣疾病，肺动脉疾病

    1. 对数据集的样本进行长度的验证
       数据集中没有长度低于2s的数据

    2. 对各类别可划分的数据量进行验证
       划分结果为 [316, 180, 691, 266]

    3. 对数据进行划分
       划分比例为：6:2:2
       划分依据：保证各类别在训练集，验证集和测试集中的类别为上述比例，且每个记录仅能出现在这三个数据集中的一个，不可重复出现。
       划分流程：读取数据；小波滤波；降采样至2k；最大最小归一化；进行当前数据的划分
       划分情况：
       其中 第二类数据在三个数据集中的数量均为60，这是因为原始的数据集中，仅有三个录音。只能每个数据集占一个了。

       ![image-20240416111544044](../../../AppData/Roaming/Typora/typora-user-images/image-20240416111544044.png)

  * Machine_2016 数据集
    该数据有两个子集，分别为set_a 和 set_b，采样率分别为 44100Hz和 4000Hz。
            这些数据集中不仅包含的类别不一致，且每个数据集均包含噪音数据，为了和上述其他数据保持一致，这里选择使用三个类别["normal", "murmur", "extrastole"]  正常，心脏杂音，额外的心音。
    注意我们可以将artifact 这一类别直接归类到额外心音这一类别中。

    1. 对数据集的样本进行长度的验证
       在去除包含噪音数据的情况下，共436条数据，其中52条数据长度小于2s，最后有384条数据可以用
    2. 对各类别可划分的数据量进行验证
       不使用噪音数据，最终的划分[769, 607, 627]
    3. 对数据进行划分
       划分比例为：6:2:2
       划分依据：保证各类别在训练集，验证集和测试集中的类别为上述比例，且每个记录仅能出现在这三个数据集中的一个，不可重复出现。
       划分流程：读取数据；小波滤波；降采样至2k；最大最小归一化；进行当前数据的划分
       划分情况：
       ![image-20240416120333271](../../../AppData/Roaming/Typora/typora-user-images/image-20240416120333271.png)

  * 

* ### 心电信号

  ==对心电数据集的划分同样采用50%重叠，但这样一来存在的问题就是每一个心电记录中包含了多个类别的心电记录，所以在划分数据集时就要确保当2倍采样率长度的数据类别是一致的。==

  * AFDB 数据集
    该数据集仅有一个类别：心房颤动。采样率为250Hz，记录包含了两个通道，但存在R波位置标记的为“ECG1”通道。

    1. 对数据集的样本进行长度的验证
       心电数据都是较长的记录，可以直接用

    2. 对各类别可划分的数据量进行验证
       不使用噪音数据，最终的划分[769, 607, 627]

    3. 对数据进行划分
       划分比例为：6:2:2
       划分依据：保证各类别在训练集，验证集和测试集中的类别为上述比例，且每个记录仅能出现在这三个数据集中的一个，不可重复出现。
       划分流程：读取数据；小波滤波；重采样至200Hz；最大最小归一化；进行当前数据的划分
       划分情况：

       ![image-20240416121440579](../../../AppData/Roaming/Typora/typora-user-images/image-20240416121440579.png)

  * nsrdb 数据集
    该数据集有多个类别，但是只有正常类别（N）是清楚的，其余类别不清楚代表的含义，故无法使用。采样率为128Hz，记录包含了两个通道，我们仅使用“ECG1”通道。

    1. 对数据集的样本进行长度的验证
       心电数据都是较长的记录，可以直接用
    2. 对各类别可划分的数据量进行验证
       最终N的数量大致为1729502
    3. 对数据进行划分
       划分比例为：6:2:2
       划分依据：保证各类别在训练集，验证集和测试集中的类别为上述比例，且每个记录仅能出现在这三个数据集中的一个，不可重复出现。
       划分流程：读取数据；小波滤波；重采样至200Hz；最大最小归一化；进行当前数据的划分
       划分情况：
       ![image-20240416154623114](../../../AppData/Roaming/Typora/typora-user-images/image-20240416154623114.png)

  * SVDB 数据集

    该数据集有多个类别，经过查看类别数量，最终选择仅使用（N,S,V）这三类数据，但即使这样，类别比例仍然极不平衡。采样率为128Hz，记录包含了两个通道，经过探查，发现R波的位置标记在“ECG1”通道更为准确，故我们选择使用“ECG1"通道

    1. 对数据集的样本进行长度的验证
       心电数据都是较长的记录，可以直接用

    2. 对各类别可划分的数据量进行验证
       最终N的记录数量为[162339,12188,9943]    

    3. 对数据进行划分
       划分比例为：6:2:2
       划分依据：保证各类别在训练集，验证集和测试集中的类别为上述比例，且每个记录仅能出现在这三个数据集中的一个，不可重复出现。
       划分流程：读取数据；小波滤波；重采样至200Hz；最大最小归一化；进行当前数据的划分
       划分情况：
       ![image-20240416161544868](../../../AppData/Roaming/Typora/typora-user-images/image-20240416161544868.png)

       ![image-20240416161650389](../../../AppData/Roaming/Typora/typora-user-images/image-20240416161650389.png)

  * LTDB 数据集

    该数据集也是有多个类别，最终使用N。 采样率为128Hz。

    1. 对数据集的样本进行长度的验证
       心电数据都是较长的记录，可以直接用

    2. 对各类别可划分的数据量进行验证
       最终N的记录总量为 669852， N为 600232, V为 64095

    3. 对数据进行划分
       划分比例为：6:2:2
       划分依据：保证各类别在训练集，验证集和测试集中的类别为上述比例，且每个记录仅能出现在这三个数据集中的一个，不可重复出现。
       划分流程：读取数据；小波滤波；重采样至200Hz；最大最小归一化；进行当前数据的划分
       划分情况：
       ![image-20240416162821609](../../../AppData/Roaming/Typora/typora-user-images/image-20240416162821609.png)

       ![image-20240416162844413](../../../AppData/Roaming/Typora/typora-user-images/image-20240416162844413.png)

  * AFPDB数据集
    该数据采样率为128Hz，有两个通道，R波标记在“ECG0”通道使用更为准确。类别的话考虑使用 N,P(PFA),最终的比例较为平衡

    1. 对数据集的样本进行长度的验证
       心电数据都是较长的记录，可以直接用

    2. 对各类别可划分的数据量进行验证
       最终N的记录总量为 271435， N为 132131, V为 139304

    3. 对数据进行划分
       划分比例为：6:2:2
       划分依据：保证各类别在训练集，验证集和测试集中的类别为上述比例，且每个记录仅能出现在这三个数据集中的一个，不可重复出现。
       划分流程：读取数据；小波滤波；重采样至200Hz；最大最小归一化；进行当前数据的划分
       划分情况：

       ![image-20240416163420958](../../../AppData/Roaming/Typora/typora-user-images/image-20240416163420958.png)

       ![image-20240416163437723](../../../AppData/Roaming/Typora/typora-user-images/image-20240416163437723.png)

  * MITDB数据集
    采样率为360Hz，有两个通道，R波标记在“ECG0”通道使用更为准确。类别的话考虑使用 N,L,R,V，最终各类别比例较为不平衡。

    1. 对数据集的样本进行长度的验证
       心电数据都是较长的记录，可以直接用
    2. 对各类别可划分的数据量进行验证
       最终N的记录总量为 271435， N为 132131, V为 139304
    3. 对数据进行划分
       划分比例为：6:2:2
       划分依据：保证各类别在训练集，验证集和测试集中的类别为上述比例，且每个记录仅能出现在这三个数据集中的一个，不可重复出现。
       划分流程：读取数据；小波滤波；重采样至200Hz；最大最小归一化；进行当前数据的划分
       划分情况：
       ![image-20240416163940990](../../../AppData/Roaming/Typora/typora-user-images/image-20240416163940990.png)
       ![image-20240416163950110](../../../AppData/Roaming/Typora/typora-user-images/image-20240416163950110.png)

  * STDB数据集
    采样率为360Hz，有两个通道，R波标记在两个ECG通道，使用第一个ECG通道。类别比例很不平衡，在这里我们选择仅使用正常类别

    1. 对数据集的样本进行长度的验证
       心电数据都是较长的记录，可以直接用

    2. 对各类别可划分的数据量进行验证
       最终N的记录总量为 76181， N为 75038

    3. 对数据进行划分
       划分比例为：6:2:2
       划分依据：保证各类别在训练集，验证集和测试集中的类别为上述比例，且每个记录仅能出现在这三个数据集中的一个，不可重复出现。
       划分流程：读取数据；小波滤波；重采样至200Hz；最大最小归一化；进行当前数据的划分
       划分情况：

       ![image-20240416165018470](../../../AppData/Roaming/Typora/typora-user-images/image-20240416165018470.png)
       

  * EDB数据集
    数据集采样率为250Hz, 两个通道，直接使用类别N。

    1. 对数据集的样本进行长度的验证
       心电数据都是较长的记录，可以直接用

    2. 对各类别可划分的数据量进行验证
       最终N的记录总量  edb1为  280036， N为 285741 ； edb2类别N为：481884 总量为 493905

    3. 对数据进行划分
       划分比例为：6:2:2
       划分依据：保证各类别在训练集，验证集和测试集中的类别为上述比例，且每个记录仅能出现在这三个数据集中的一个，不可重复出现。
       划分流程：读取数据；小波滤波；重采样至200Hz；最大最小归一化；进行当前数据的划分
       划分情况：
       ![image-20240416165544472](../../../AppData/Roaming/Typora/typora-user-images/image-20240416165544472.png)

       

  * SDDB数据集
    采样率为250Hz，有两个通道，均为“ECG”，R波标记使用第一个“ECG”通道。类别的话使用[N,S,V,r]，但是类别比例极不平衡。

    1. 对数据集的样本进行长度的验证
       心电数据都是较长的记录，可以直接用

    2. 对各类别可划分的数据量进行验证
       最终的记录 [N': 1787515, 'r': 58820, 'S': 22085, 'V': 19569]  数据总量为1894241

    3. 对数据进行划分
       划分比例为：6:2:2
       划分依据：保证各类别在训练集，验证集和测试集中的类别为上述比例，且每个记录仅能出现在这三个数据集中的一个，不可重复出现。
       划分流程：读取数据；小波滤波；重采样至200Hz；最大最小归一化；进行当前数据的划分
       划分情况：

       ![image-20240416170402998](../../../AppData/Roaming/Typora/typora-user-images/image-20240416170402998.png)

       ![image-20240416170423610](../../../AppData/Roaming/Typora/typora-user-images/image-20240416170423610.png)

  * 

* ### 脑电信号

  脑电信号（EEG）和心电信号（ECG）的频率范围有所不同。一般来说，脑电信号的频率范围在0.5 Hz到100 Hz之间，包括多种脑波频率，如δ波（0.5-4 Hz）、θ波（4-8 Hz）、α波（8-13 Hz）、β波（13-30 Hz）和γ波（30-100 Hz）。

  而心电信号的频率范围通常在0.5 Hz到100 Hz之间，但最显著的频率范围集中在0.5 Hz到40 Hz之间，包括QRS波在内的心脏特征频率。

  对于脑电信号来说，可以使用和小波滤波一样的函数，我们在心电滤波中使用的滤波性能较低，尽量保证在减少噪音的同时，最大程度保留原始信号特征。

  *  ==EEG During Mental Arithmetic Tasks==  心算前后的受试者脑电图
    **数据集介绍：** 采样率为500Hz，`_1`表示心算前的脑电信号，`_2`表示心算期间的脑电信号。在注释csv文         				        件中，0表示数据质量较差，1表示质量较好。

    **数据集划分：** 标签分为三类，心算前标签为0，心算中质量较差的为1，心算中质量较好的为2。当把1和2					    合为一类，即为二分类数据。

    **数据集查看：** 心算前的数据量大约是心算期间数据量的3倍，个别数据的数据量或多一点，或少一点，但						是整体来说数据量的分布较为均衡，心算前数据量基本都为91000，心算后的数据量基本都						为31000。通道数均为21，前20个为脑电的，最后一个为心电数据。经过计算，心算前数						据可划分的数据量为3186，心算后数据可划分的数据量为1080。
    **数据集划分：** 划分比例为6:2:2，流程为：读取文件，获取信号通道数，获取信号，关闭文件，波形去噪，最大最小归一化。==对于脑电信号来说，少考虑了一些东西，下面继续分析==

    **数据集继续分析：** 读取数据，获取脑电以及心电通道名称并查看，创建仅包含脑电信号通道的新raw对象（raw_eeg），若名称不符合命名规则则进行名称的替换，创建通用的10-20电极Montage对象，将Montage对象应用到原始数据中，滤波（0.1-40Hz的带通滤波，50Hz的陷波滤波器），以'A2'电极为重参考，查看重参考后的电极，运用ICA进行分析。

    **ICA主成分分析：** 其本身是将一个混杂了多种信息的信号分解为一个个独立的信号。ICA可以分离出肌电，眼动，眨眼，心跳等伪迹，然后提出这些成分。

    **ICA使用步骤：** 创建ICA实例，拟合原始脑电信号，绘制独立成分，寻找不合适的成分并去除，给原始数据应用ICA处理，绘制原始数据与ICA处理后的数据并进行细节对比。  ==注意：ICA去除的是独立成分，并不是对应的原始信号，去除这些成分之后再合成原始信号，肯定和原来的信号是不一样的。== 

    **数据集最终处理：** 脑电ICA分析，心电小波滤波

    **数据集划分结果：** 

    ![image-20240417093905113](../../../AppData/Roaming/Typora/typora-user-images/image-20240417093905113.png)

    ![image-20240417094918262](../../../AppData/Roaming/Typora/typora-user-images/image-20240417094918262.png)

  * **2.eeg-Motor-MovementImagery-Dataset**   脑电图 运动/想象 数据集

    * **数据集介绍**：该数据集共有109名志愿者的脑电记录，标号从 S001-S109，64通道脑电图，每个受试者进行了14次试验，每次实验的名称命名为 标号+R01 — 标号+R14。  采样率为160Hz， 官方将任务划分成了T0，T1，T2.  分别对应于休息，运动的开始：左拳和双拳   ，运动的开始：右拳和双脚。

      在14次实验中，R01和R02实验的内容的闭眼和睁眼，因此均属于T0，但是这样一来会导致T0的数据过多，故我们在数据处理中，直接去掉这两次试验的数据，从R03开始读取数据。

    * **数据集划分**： 通过mne包中的函数对该数据集中的任务类型进行读取，并自动划分，对应的标签自然是3类。 划分比例依然是尽量保证6:2:2，但是因为数据集存在长度不一致的问题，且本身是按照参与测试数据的人数进行划分，所以最终的数据量比例在    训练集：验证集：测试集   上无法完全做到6:2:2。

    * **数据读取与分析：**  

      1. 首先需要创建两个类型一致的读取函数，一个用于读取外层目录（S001—S109）,一个用于读取内层目录（R03—R14）；

      2. 接着开始进行脑电电极的校正（原始数据中，读取完的脑电电极与标准的脑电电极名称存在很大差异，所以需要进行校正），重命名电极名称，创建一个通用的10-20电极系统的Montage对象，将Montage对象应用到原始数据中。
      3. 对64通道电极进行重参考，参考网络上的通用处理方式，使用平均电极作为重参考电极。
      4. 创建ICA对象，使用20-30个独立源即可（本文使用了30个独立源）。
      5. 查看各个独立分量并去除一些可以确定是眼动或者脑电的分量（本数据集去除了0,21）
      6. 从数据中读取事件信号（所谓事件信号，包含了任务发生的时间，标签），我们的标签就得到了
      7. 利用events，原始数据对数据进行划分，需要注意的是设置好 tmin以及tmax，得到epochs
      8. 在epochs中存在错误日志，会有一些划分错误的情况，此时就需要进行循环判断了，将对应位置的标签进行删除，以此来保证标签与数据的一致性。
      9. 在读取数据过程中，划分比例依据人数控制，而若存在数据个数与标签个数不一致的情况，那这时的数据就需要移除，同时还会有数据长度(526)与标准长度(657)不一致的情况，此时也需要移除该数据。
      10. 最后对读取完的数据进行保存，保存的结果为：  21666:6671:6250  基本符合 6:2:2，通道数64，数据长度：657。

  * **==3.CAP Sleep Database==**  Cyclic Alternating Pattern(CAP)  循环交替模式 睡眠数据集

    * **数据集介绍**：108条多导睡眠图记录。每个记录包括3个或更多的脑电信号。
      ![image-20240506161230848](../../../AppData/Roaming/Typora/typora-user-images/image-20240506161230848.png)

    * **数据集简单分析**： 从采样率上看，分布较为统一，基本上均为512Hz的采样率。从高通低通的滤波情况看，仍旧是0.3-30Hz范围内的居多。 从通道数上看，分布比较杂乱，以22 23 18这三类居多，从画出来的波形图上看，和之前处理的脑电差别较大，没办法进行简单处理后直接使用。

    * **数据集定论**： ==数据量较大，且无法使用==

      

  * **==3.Haaglanden Medisch Centrum sleep staging database==**  荷兰海牙医疗中心 睡眠分期数据库

    * **数据集介绍**：官网介绍151条数据，最后的命名之所以到了154是因为中间有些命名被跳过了。
    
    *  **数据集查看**：
      
      1. 所有采样率均为256Hz，其中高通滤波均为0.2Hz，低通滤波83个为35Hz，68个为128Hz，数据集通道数均为 8， 且通道名称在这151条数据中均是一致的，数据点数会有所差别，有的很长，但是不影响我们最后的使用。
      2. 对于波形图，时间开始的一个阶段，信号图比较乱，再往后走，能够较为容易地分辨出来。因此需要考虑删除一点开始采集的信号。
      3. 关于注释的问题，我们读取下载文件自带的睡眠记录 .edf文件，发现无法使用，但是可以使用自带的 .txt文件，且因为该文件已经使用","直接分隔开，所以我们直接将其转换为dataframe格式，并读取里面的注释。
      
    * **数据集具体操作**：
    
      1. 编写读取文件的函数，包括 .edf文件以及 .txt 文件
    
      2. 编写数据滤波函数，这里直接引用之前的处理方式即可，db8，9层分解，将低频分量直接置0，高频分量中对 7 8 9 进行降噪。
    
      3. 创建标签对应的字典，设置一些默认参数，开始读取数据
    
      4. 读取数据，读取标签，带通滤波，对注释文件进行操作，设置文件读取的开始和结尾，进行循环读取数据，对每一个读取到的数据进行降采样，滤波和归一化，最后保存数据和标签。
    
      5. 经过测试，单独保存一个数据，其大小大约在 200-250MB之间，所以存储的时候采取分段，每读取30个数据，就保存一次。
    
         
    
  * **==4.UC San Diego Resting State EEG Data from Patients with Parkinson's Disease==**  
  
    加州大学圣地亚哥分校帕金森病患者（简称PD）的静息状态脑电图数据
    [数据集链接](https://openneuro.org/datasets/ds002778/versions/1.0.5)
  
    *  **数据集认识**：在上述链接中点击进去可以直接下载，但是如果需要查看详细的数据集介绍，需要查看相关论文
       ![image-20240507202831378](../../../AppData/Roaming/Typora/typora-user-images/image-20240507202831378.png)
    *  **数据集介绍**：数据集包括15名PD患者和16名健康者，采样率可能均为512Hz。  在pd数据集中，又分为停止药物治疗(off medication)和接受药物治疗(on medication)。
    *  **数据集分析**：
       1. 将15名PD患者使用药物和不使用药物进行区分的话，共有46个样本，采样率均为512Hz，低通滤波中44个为104Hz，2个为256Hz（pd16 on  和 pd6 on），而通道数均一致，共有41个通道，其中32个脑电电极，8个“EXG1- EXG8”，1个“Status”。每个样本的数据长度差异不大。
    *  **数据初始分析的基础步骤仍然可以分为以下几个步骤：**
       1. 导包
       2. 分析数据文件，并编写读取文件的函数，滤波代码
       3. 对单个数据进行读取，查看一些简单的信息
       4. 对所有数据进行读取，获取统计信息，查看数据是否规整，存在哪些问题。当问题过大时，该项数据应该被认为无法使用，当只有一小部分数据有问题时，那就直接剔除这些数据。
       5. 查看数据波形图
       6. 若数据需要重新进行滤波，则设置对应的带通滤波已经陷波滤波
       7. 查看通道总数，具体的通道名称，标准电极图以及对应的名称，若需要分离通道则需要进行设置，我们使用ICA分析时仅对脑电进行处理
       8. 对脑电进行ICA分析，查看是否明显眼动或者心电的成分，进行去除。最后将分离的数据进行汇总，并查看对整体进行小波滤波是否有较大影响。
    *  **数据划分的步骤：**
       1. 确定划分的对象，如何划分，务必自己先进行实验，设置好文件读取的顺序。
       2. 设置默认参数，数据保存的数组等等
       3. 确定数据保存的位置（训练，验证，测试），设置好数据读取路径，标签，开始读取数据
       4. 带通滤波，陷波滤波，通道分离，标准电极系统的创建与加载，ICA分析，数据合并，数据掐头去尾，数据分段，单个数据的归一化，去噪，保存。
    
  * **==5. Computational methods of EEG signals analysis for Alzheimer's disease classification==**  
  
    阿尔茨海默病分类的脑电信号分析计算方法  老年痴呆
    [数据集链接](https://osf.io/2v5md/)
  
    [EEG中10-20和10-10标准导联确定电极位置](https://blog.csdn.net/weixin_41880581/article/details/103840303)
  
    * **数据集认识**：19个电极位置，24名健康老人，其中12个睁眼，12个闭眼。  160名患者，其中80名睁眼，80名闭眼。
    * **数据集介绍：** 采样率为128Hz，记录了8s，使用了带通滤波，范围为 0.5-30Hz，且由技术员去除了其中的运动伪影。
    * **数据集处理：** 编写读取函数，查看数据文件分布，设置训练集，验证集，测试集；读取过程需要设置划分的标志，确定通道数为21，
  
  * **==6. A dataset of EEG recordings from: Alzheimer's disease, Frontotemporal dementia and Healthy subjects==**  
  
    来自阿尔茨海默病、额颞叶痴呆和健康受试者的脑电图记录数据集
    [数据集链接](https://openneuro.org/datasets/ds004504/versions/1.0.7)
  
    * **数据集认识**：36名阿尔兹海默症（AD），23个额颞叶痴呆症（FTD）, 29人健康（CN）,19个电极位置，（Fp1、Fp2、F7、F3、Fz、F4、F8、T3、C3、Cz、C4、T4、T5、P3、Pz、P4、T6、O1 和 O2），采样率500Hz，高频滤波器为70 Hz。
    * **数据预处理**： 下载的数据集, deruvatives的数据集经过了预处理，包括0.5-45Hz的带通滤波，并将信号重参考到了A1-A2，去除了一些不良数据，并进行了ICA分析，19个通道使用了19个ICA分量。 (即使记录是在静止状态下进行的，闭眼状态，在一些脑电图记录中仍然发现了眼球运动的眼睛伪影。)
  
  * **==7. 癫痫疾病==**  
    [数据集链接](https://www.ukbonn.de/epileptologie/arbeitsgruppen/ag-lehnertz-neurophysik/downloads/)
  
    1. 我们研究中分析的数据可在此页面上找到。数据采样率为173.61 Hz。时间序列具有采集系统的频谱带宽，即 0.5 Hz 至 85 Hz。对于每个集合 （A-E），都有一个包含 100 个 TXT 文件的 ZIP 文件。每个 TXT 文件由 4096 个 ASCII 码的 EEG 时间序列样本组成。
    2. 研究对象为5组共，分别为A-E，每组包含100个持续时间为23.6秒的单通道脑电节段。
    3. A和B的信号来自5名健康志愿者，数据采集时志愿者均为清醒状态，A数据是睁眼的信号，B数据是闭眼的信号。
    4.  C D 和 E 是患者的术前诊断脑电图，5名患者。  C和D仅包含无癫痫发作期间的活动，而E包含癫痫活动 带通滤波器设置的是 0.53-40Hz。
  
    * **数据集分析：** 只有10名患者是不是太少了？ 不过现在由于完全打乱，所以不能使用用户区分的方法进行数据集划分，只能全部读取完划分数据。
    * 
  
  * **==8. EEG DATA FOR ADHD / CONTROL CHILDREN==**  
    多动症/对照儿童的脑电图数据
    [数据集链接](https://ieee-dataport.org/open-access/eeg-data-adhd-control-children)
  
    * **数据集认识：**
      1. 参与者是 61 名患有 ADHD 的儿童和 60 名健康对照者（男孩和女孩，年龄在 7-12 岁之间）。ADHD 儿童被经验丰富的精神科医生诊断为 DSM-IV 标准，并服用利他林长达 6 个月。对照组中没有儿童有精神疾病、癫痫病史或任何高危行为报告。
      2. 在128 Hz采样频率下，通过19个通道（Fz、Cz、Pz、C3、T3、C4、T4、Fp1、Fp2、F3、F4、F7、F8、P3、P4、T5、T6、O1、O2）在10-20个标准进行脑电图记录。A1 和 A2 电极是位于耳垂上的参考。
      3. 由于ADHD儿童的缺陷之一是视觉注意力，因此脑电图记录协议基于视觉注意力任务。在任务中，向孩子们展示了一组卡通人物的图片，并要求他们数数人物。每张图片中的字符数在5到16之间随机选择，图片的大小足够大，儿童可以很容易地看到和数出。为了在信号记录过程中获得连续的刺激，在孩子做出反应后立即不间断地显示每个图像。因此，在整个认知视觉任务中，脑电图记录的持续时间取决于儿童的表现（即反应速度）。















